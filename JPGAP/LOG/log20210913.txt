2021/09/13 15:49:05|WITH Z AS ( SELECT KURACD        , TRIM(REPLACE(acbcd,'　','')) AS acbcd        , kmcd1        , COUNT(*) AS CNT FROM   t10_keiho WHERE  1 = 1 AND    kmYMD BETWEEN :TRGDATE_FROM AND :TRGDATE_TO GROUP BY KURACD, acbCD, kmcd1 ORDER BY KURACD, acbCD, kmcd1 ) SELECT Z.KURACD        , Z.KURACD || ':' || C.CLI_NAME AS KURADISP        , Z.acbCD        , Z.acbCD || ':' || Z.acbcd AS JADISP        , SUM(DECODE(z.kmcd1 ,'08',CNT,0)) AS C01        , SUM(CNT) AS SUMA FROM   Z LEFT JOIN CLIMAS C ON Z.KURACD = C.CLI_CD GROUP BY Z.KURACD          , Z.acbCD          , C.CLI_NAME 
2021/09/13 15:50:18|WITH Z AS ( SELECT KURACD        , JACD        , TRIM(REPLACE(JANM,'　','')) AS JANM        , HATKBN        , TAIOKBN        , COUNT(*) AS CNT FROM   D20_TAIOU WHERE  1 = 1 AND    SYOYMD BETWEEN :TRGDATE_FROM AND :TRGDATE_TO AND    (TAIOKBN = :TAIOKBN1 OR TAIOKBN = :TAIOKBN2 )  AND TSADCD = :TSADCD GROUP BY KURACD, JACD, TRIM(REPLACE(JANM,'　','')), HATKBN, TAIOKBN ORDER BY KURACD, JACD, HATKBN, TAIOKBN ) SELECT Z.KURACD        , Z.KURACD || ':' || C.CLI_NAME AS KURADISP        , Z.JACD        , Z.JACD || ':' || Z.JANM AS JADISP        , SUM(DECODE(HATKBN || TAIOKBN,'12',CNT,0)) AS C01        , SUM(DECODE(HATKBN || TAIOKBN,'11',CNT,0)) AS C02        , SUM(DECODE(HATKBN,'1',CNT,0)) AS SUM1        , SUM(DECODE(HATKBN || TAIOKBN,'22',CNT,0)) AS C03        , SUM(DECODE(HATKBN || TAIOKBN,'21',CNT,0)) AS C04        , SUM(DECODE(HATKBN,'2',CNT,0)) AS SUM2        , SUM(CNT) AS SUMA FROM   Z LEFT JOIN CLIMAS C ON Z.KURACD = C.CLI_CD GROUP BY Z.KURACD          , Z.JACD          , Z.JANM          , C.CLI_NAME UNION ALL SELECT Z.KURACD        , '' AS KURADISP        , '' AS JACD        , '小計' AS JADISP        , SUM(DECODE(HATKBN || TAIOKBN,'12',CNT,0)) AS C01        , SUM(DECODE(HATKBN || TAIOKBN,'11',CNT,0)) AS C02        , SUM(DECODE(HATKBN,'1',CNT,0)) AS SUM1        , SUM(DECODE(HATKBN || TAIOKBN,'22',CNT,0)) AS C03        , SUM(DECODE(HATKBN || TAIOKBN,'21',CNT,0)) AS C04        , SUM(DECODE(HATKBN,'2',CNT,0)) AS SUM2        , SUM(CNT) AS SUMA FROM   Z GROUP BY KURACD UNION ALL SELECT 'XYZ' AS KURACD        , '総合計' AS KURADISP        , '' AS JACD        , '' AS JADISP        , SUM(DECODE(HATKBN || TAIOKBN,'12',CNT,0)) AS C01        , SUM(DECODE(HATKBN || TAIOKBN,'11',CNT,0)) AS C02        , SUM(DECODE(HATKBN,'1',CNT,0)) AS SUM1        , SUM(DECODE(HATKBN || TAIOKBN,'22',CNT,0)) AS C03        , SUM(DECODE(HATKBN || TAIOKBN,'21',CNT,0)) AS C04        , SUM(DECODE(HATKBN,'2',CNT,0)) AS SUM2        , SUM(CNT) AS SUMA FROM   Z ORDER BY KURACD, JACD 
2021/09/13 20:46:47|WITH Z AS ( SELECT KURACD        , TRIM(REPLACE(acbcd,'　','')) AS acbcd        , kmcd1        , COUNT(*) AS CNT FROM   t10_keiho WHERE  1 = 1 AND    kmYMD BETWEEN :TRGDATE_FROM AND :TRGDATE_TO GROUP BY KURACD, acbCD, kmcd1 ORDER BY KURACD, acbCD, kmcd1 ) SELECT Z.KURACD        , Z.KURACD || ':' || C.CLI_NAME AS KURADISP        , Z.acbCD        , Z.acbCD || ':' || Z.acbcd AS JADISP        , SUM(DECODE(z.kmcd1 ,'08',CNT,0)) AS C01        , SUM(CNT) AS SUMA FROM   Z LEFT JOIN CLIMAS C ON Z.KURACD = C.CLI_CD GROUP BY Z.KURACD          , Z.acbCD          , C.CLI_NAME 
2021/09/13 20:59:59|WITH Z AS ( SELECT KURACD        , TRIM(REPLACE(acbcd,'　','')) AS acbcd        , kmcd1        , COUNT(*) AS CNT FROM   t10_keiho WHERE  1 = 1 AND    kmYMD BETWEEN :TRGDATE_FROM AND :TRGDATE_TO GROUP BY KURACD, acbCD, kmcd1 ORDER BY KURACD, acbCD, kmcd1 ) SELECT Z.KURACD        , Z.KURACD || ':' || C.CLI_NAME AS KURADISP        , Z.acbCD        , Z.acbCD || ':' || Z.acbcd AS JADISP        , SUM(DECODE(z.kmcd1 ,'08',CNT,0)) AS C01        , SUM(CNT) AS SUMA FROM   Z LEFT JOIN CLIMAS C ON Z.KURACD = C.CLI_CD GROUP BY Z.KURACD          , Z.acbCD          , C.CLI_NAME 
2021/09/13 21:00:08|WITH Z AS ( SELECT KURACD        , TRIM(REPLACE(acbcd,'　','')) AS acbcd        , kmcd1        , COUNT(*) AS CNT FROM   t10_keiho WHERE  1 = 1 AND    kmYMD BETWEEN :TRGDATE_FROM AND :TRGDATE_TO GROUP BY KURACD, acbCD, kmcd1 ORDER BY KURACD, acbCD, kmcd1 ) SELECT Z.KURACD        , Z.KURACD || ':' || C.CLI_NAME AS KURADISP        , Z.acbCD        , Z.acbCD || ':' || Z.acbcd AS JADISP        , SUM(DECODE(z.kmcd1 ,'08',CNT,0)) AS C01        , SUM(CNT) AS SUMA FROM   Z LEFT JOIN CLIMAS C ON Z.KURACD = C.CLI_CD GROUP BY Z.KURACD          , Z.acbCD          , C.CLI_NAME 
2021/09/13 21:01:42|WITH Z AS ( SELECT KURACD        , JACD        , TRIM(REPLACE(JANM,'　','')) AS JANM        , HATKBN        , TAIOKBN        , COUNT(*) AS CNT FROM   D20_TAIOU WHERE  1 = 1 AND    SYOYMD BETWEEN :TRGDATE_FROM AND :TRGDATE_TO AND    (TAIOKBN = :TAIOKBN1 OR TAIOKBN = :TAIOKBN2 )  AND TSADCD = :TSADCD GROUP BY KURACD, JACD, TRIM(REPLACE(JANM,'　','')), HATKBN, TAIOKBN ORDER BY KURACD, JACD, HATKBN, TAIOKBN ) SELECT Z.KURACD        , Z.KURACD || ':' || C.CLI_NAME AS KURADISP        , Z.JACD        , Z.JACD || ':' || Z.JANM AS JADISP        , SUM(DECODE(HATKBN || TAIOKBN,'12',CNT,0)) AS C01        , SUM(DECODE(HATKBN || TAIOKBN,'11',CNT,0)) AS C02        , SUM(DECODE(HATKBN,'1',CNT,0)) AS SUM1        , SUM(DECODE(HATKBN || TAIOKBN,'22',CNT,0)) AS C03        , SUM(DECODE(HATKBN || TAIOKBN,'21',CNT,0)) AS C04        , SUM(DECODE(HATKBN,'2',CNT,0)) AS SUM2        , SUM(CNT) AS SUMA FROM   Z LEFT JOIN CLIMAS C ON Z.KURACD = C.CLI_CD GROUP BY Z.KURACD          , Z.JACD          , Z.JANM          , C.CLI_NAME UNION ALL SELECT Z.KURACD        , '' AS KURADISP        , '' AS JACD        , '小計' AS JADISP        , SUM(DECODE(HATKBN || TAIOKBN,'12',CNT,0)) AS C01        , SUM(DECODE(HATKBN || TAIOKBN,'11',CNT,0)) AS C02        , SUM(DECODE(HATKBN,'1',CNT,0)) AS SUM1        , SUM(DECODE(HATKBN || TAIOKBN,'22',CNT,0)) AS C03        , SUM(DECODE(HATKBN || TAIOKBN,'21',CNT,0)) AS C04        , SUM(DECODE(HATKBN,'2',CNT,0)) AS SUM2        , SUM(CNT) AS SUMA FROM   Z GROUP BY KURACD UNION ALL SELECT 'XYZ' AS KURACD        , '総合計' AS KURADISP        , '' AS JACD        , '' AS JADISP        , SUM(DECODE(HATKBN || TAIOKBN,'12',CNT,0)) AS C01        , SUM(DECODE(HATKBN || TAIOKBN,'11',CNT,0)) AS C02        , SUM(DECODE(HATKBN,'1',CNT,0)) AS SUM1        , SUM(DECODE(HATKBN || TAIOKBN,'22',CNT,0)) AS C03        , SUM(DECODE(HATKBN || TAIOKBN,'21',CNT,0)) AS C04        , SUM(DECODE(HATKBN,'2',CNT,0)) AS SUM2        , SUM(CNT) AS SUMA FROM   Z ORDER BY KURACD, JACD 
2021/09/13 21:03:08|WITH Z AS ( SELECT KURACD        , JACD        , TRIM(REPLACE(JANM,'　','')) AS JANM        , HATKBN        , TAIOKBN        , COUNT(*) AS CNT FROM   D20_TAIOU WHERE  1 = 1 AND    SYOYMD BETWEEN :TRGDATE_FROM AND :TRGDATE_TO AND    (TAIOKBN = :TAIOKBN1 OR TAIOKBN = :TAIOKBN2 )  AND TSADCD = :TSADCD GROUP BY KURACD, JACD, TRIM(REPLACE(JANM,'　','')), HATKBN, TAIOKBN ORDER BY KURACD, JACD, HATKBN, TAIOKBN ) SELECT Z.KURACD        , Z.KURACD || ':' || C.CLI_NAME AS KURADISP        , Z.JACD        , Z.JACD || ':' || Z.JANM AS JADISP        , SUM(DECODE(HATKBN || TAIOKBN,'12',CNT,0)) AS C01        , SUM(DECODE(HATKBN || TAIOKBN,'11',CNT,0)) AS C02        , SUM(DECODE(HATKBN,'1',CNT,0)) AS SUM1        , SUM(DECODE(HATKBN || TAIOKBN,'22',CNT,0)) AS C03        , SUM(DECODE(HATKBN || TAIOKBN,'21',CNT,0)) AS C04        , SUM(DECODE(HATKBN,'2',CNT,0)) AS SUM2        , SUM(CNT) AS SUMA FROM   Z LEFT JOIN CLIMAS C ON Z.KURACD = C.CLI_CD GROUP BY Z.KURACD          , Z.JACD          , Z.JANM          , C.CLI_NAME UNION ALL SELECT Z.KURACD        , '' AS KURADISP        , '' AS JACD        , '小計' AS JADISP        , SUM(DECODE(HATKBN || TAIOKBN,'12',CNT,0)) AS C01        , SUM(DECODE(HATKBN || TAIOKBN,'11',CNT,0)) AS C02        , SUM(DECODE(HATKBN,'1',CNT,0)) AS SUM1        , SUM(DECODE(HATKBN || TAIOKBN,'22',CNT,0)) AS C03        , SUM(DECODE(HATKBN || TAIOKBN,'21',CNT,0)) AS C04        , SUM(DECODE(HATKBN,'2',CNT,0)) AS SUM2        , SUM(CNT) AS SUMA FROM   Z GROUP BY KURACD UNION ALL SELECT 'XYZ' AS KURACD        , '総合計' AS KURADISP        , '' AS JACD        , '' AS JADISP        , SUM(DECODE(HATKBN || TAIOKBN,'12',CNT,0)) AS C01        , SUM(DECODE(HATKBN || TAIOKBN,'11',CNT,0)) AS C02        , SUM(DECODE(HATKBN,'1',CNT,0)) AS SUM1        , SUM(DECODE(HATKBN || TAIOKBN,'22',CNT,0)) AS C03        , SUM(DECODE(HATKBN || TAIOKBN,'21',CNT,0)) AS C04        , SUM(DECODE(HATKBN,'2',CNT,0)) AS SUM2        , SUM(CNT) AS SUMA FROM   Z ORDER BY KURACD, JACD 
2021/09/13 21:59:07|WITH Z AS ( SELECT KURACD        , TRIM(REPLACE(acbcd,'　','')) AS acbcd        , kmcd1        , COUNT(*) AS CNT FROM   t10_keiho WHERE  1 = 1 AND    kmYMD BETWEEN :TRGDATE_FROM AND :TRGDATE_TO GROUP BY KURACD, acbCD, kmcd1 ORDER BY KURACD, acbCD, kmcd1 ) SELECT Z.KURACD        , Z.KURACD || ':' || C.CLI_NAME AS KURADISP        , Z.acbCD        , Z.acbCD || ':' || Z.acbcd AS JADISP        , SUM(DECODE(z.kmcd1 ,'08',CNT,0)) AS C01        , SUM(CNT) AS SUM2        , SUM(CNT) AS SUMA FROM   Z LEFT JOIN CLIMAS C ON Z.KURACD = C.CLI_CD GROUP BY Z.KURACD          , Z.acbCD          , C.CLI_NAME UNION ALL select z.kuracd,''as kuradisp,''as acbcd,'小計'as jadisp        , SUM(DECODE(z.kmcd1 ,'08',CNT,0)) AS C01        , SUM(CNT) AS SUM2        , SUM(CNT) AS SUMA from z group by kuracd UNION ALL select'XYZ'as kuracd,'総合計'as kuradisp,''as acbcd,''as jadisp        , SUM(DECODE(z.kmcd1 ,'08',CNT,0)) AS C01        , SUM(CNT) AS SUM2        , SUM(CNT) AS SUMA from z order by kuracd,acbcd 
2021/09/13 22:08:05|WITH Z AS ( SELECT KURACD        , TRIM(REPLACE(acbcd,'　','')) AS acbcd        , kmcd1        , COUNT(*) AS CNT FROM   t10_keiho WHERE  1 = 1 AND    kmYMD BETWEEN :TRGDATE_FROM AND :TRGDATE_TO GROUP BY KURACD, acbCD, kmcd1 ORDER BY KURACD, acbCD, kmcd1 ) SELECT Z.KURACD        , Z.KURACD || ':' || C.CLI_NAME AS KURADISP        , Z.acbCD        , Z.acbCD || ':' || Z.acbcd AS JADISP        , SUM(DECODE(z.kmcd1 ,'08',CNT,0)) AS C01        , SUM(CNT) AS SUM2        , SUM(CNT) AS SUMA FROM   Z LEFT JOIN CLIMAS C ON Z.KURACD = C.CLI_CD GROUP BY Z.KURACD          , Z.acbCD          , C.CLI_NAME UNION ALL select z.kuracd,''as kuradisp,''as acbcd,'小計'as jadisp        , SUM(DECODE(z.kmcd1 ,'08',CNT,0)) AS C01        , SUM(CNT) AS SUM2        , SUM(CNT) AS SUMA from z group by kuracd UNION ALL select'XYZ'as kuracd,'総合計'as kuradisp,''as acbcd,''as jadisp        , SUM(DECODE(z.kmcd1 ,'08',CNT,0)) AS C01        , SUM(CNT) AS SUM2        , SUM(CNT) AS SUMA from z order by kuracd,acbcd 
2021/09/13 22:09:01|WITH Z AS ( SELECT KURACD        , TRIM(REPLACE(acbcd,'　','')) AS acbcd        , kmcd1        , COUNT(*) AS CNT FROM   t10_keiho WHERE  1 = 1 AND    KURACD >= :KURACD_FROM AND    KURACD <= :KURACD_TO AND    kmYMD BETWEEN :TRGDATE_FROM AND :TRGDATE_TO GROUP BY KURACD, acbCD, kmcd1 ORDER BY KURACD, acbCD, kmcd1 ) SELECT Z.KURACD        , Z.KURACD || ':' || C.CLI_NAME AS KURADISP        , Z.acbCD        , Z.acbCD || ':' || Z.acbcd AS JADISP        , SUM(DECODE(z.kmcd1 ,'08',CNT,0)) AS C01        , SUM(CNT) AS SUM2        , SUM(CNT) AS SUMA FROM   Z LEFT JOIN CLIMAS C ON Z.KURACD = C.CLI_CD GROUP BY Z.KURACD          , Z.acbCD          , C.CLI_NAME UNION ALL select z.kuracd,''as kuradisp,''as acbcd,'小計'as jadisp        , SUM(DECODE(z.kmcd1 ,'08',CNT,0)) AS C01        , SUM(CNT) AS SUM2        , SUM(CNT) AS SUMA from z group by kuracd UNION ALL select'XYZ'as kuracd,'総合計'as kuradisp,''as acbcd,''as jadisp        , SUM(DECODE(z.kmcd1 ,'08',CNT,0)) AS C01        , SUM(CNT) AS SUM2        , SUM(CNT) AS SUMA from z order by kuracd,acbcd 
2021/09/13 22:09:27|WITH Z AS ( SELECT KURACD        , TRIM(REPLACE(acbcd,'　','')) AS acbcd        , kmcd1        , COUNT(*) AS CNT FROM   t10_keiho WHERE  1 = 1 AND    KURACD >= :KURACD_FROM AND    KURACD <= :KURACD_TO AND    kmYMD BETWEEN :TRGDATE_FROM AND :TRGDATE_TO GROUP BY KURACD, acbCD, kmcd1 ORDER BY KURACD, acbCD, kmcd1 ) SELECT Z.KURACD        , Z.KURACD || ':' || C.CLI_NAME AS KURADISP        , Z.acbCD        , Z.acbCD || ':' || Z.acbcd AS JADISP        , SUM(DECODE(z.kmcd1 ,'08',CNT,0)) AS C01        , SUM(CNT) AS SUM2        , SUM(CNT) AS SUMA FROM   Z LEFT JOIN CLIMAS C ON Z.KURACD = C.CLI_CD GROUP BY Z.KURACD          , Z.acbCD          , C.CLI_NAME UNION ALL select z.kuracd,''as kuradisp,''as acbcd,'小計'as jadisp        , SUM(DECODE(z.kmcd1 ,'08',CNT,0)) AS C01        , SUM(CNT) AS SUM2        , SUM(CNT) AS SUMA from z group by kuracd UNION ALL select'XYZ'as kuracd,'総合計'as kuradisp,''as acbcd,''as jadisp        , SUM(DECODE(z.kmcd1 ,'08',CNT,0)) AS C01        , SUM(CNT) AS SUM2        , SUM(CNT) AS SUMA from z order by kuracd,acbcd 
2021/09/13 22:24:12|WITH Z AS ( SELECT KURACD        , TRIM(REPLACE(acbcd,'　','')) AS acbcd        , kmcd1        , COUNT(*) AS CNT FROM   t10_keiho WHERE  1 = 1 AND    kmYMD BETWEEN :TRGDATE_FROM AND :TRGDATE_TO GROUP BY KURACD, acbCD, kmcd1 ORDER BY KURACD, acbCD, kmcd1 ) SELECT Z.KURACD        , Z.KURACD || ':' || C.CLI_NAME AS KURADISP        , Z.acbCD        , Z.acbCD || ':' || Z.acbcd AS JADISP        , SUM(DECODE(z.kmcd1 ,'08',CNT,0)) AS C01        , SUM(CNT) AS SUM2        , SUM(CNT) AS SUMA FROM   Z LEFT JOIN CLIMAS C ON Z.KURACD = C.CLI_CD GROUP BY Z.KURACD          , Z.acbCD          , C.CLI_NAME UNION ALL select z.kuracd,''as kuradisp,''as acbcd,'小計'as jadisp        , SUM(DECODE(z.kmcd1 ,'08',CNT,0)) AS C01        , SUM(CNT) AS SUM2        , SUM(CNT) AS SUMA from z group by kuracd UNION ALL select'XYZ'as kuracd,'総合計'as kuradisp,''as acbcd,''as jadisp        , SUM(DECODE(z.kmcd1 ,'08',CNT,0)) AS C01        , SUM(CNT) AS SUM2        , SUM(CNT) AS SUMA from z order by kuracd,acbcd 
2021/09/13 22:24:53|WITH Z AS ( SELECT KURACD        , TRIM(REPLACE(acbcd,'　','')) AS acbcd        , kmcd1        , COUNT(*) AS CNT FROM   t10_keiho WHERE  1 = 1 AND    KURACD >= :KURACD_FROM AND    KURACD <= :KURACD_TO AND    KURACD || acbCD >= :JACD_FROM_CLI || :JACD_FROM AND    KURACD || acbCD <= :JACD_TO_CLI || :JACD_TO AND    kmYMD BETWEEN :TRGDATE_FROM AND :TRGDATE_TO GROUP BY KURACD, acbCD, kmcd1 ORDER BY KURACD, acbCD, kmcd1 ) SELECT Z.KURACD        , Z.KURACD || ':' || C.CLI_NAME AS KURADISP        , Z.acbCD        , Z.acbCD || ':' || Z.acbcd AS JADISP        , SUM(DECODE(z.kmcd1 ,'08',CNT,0)) AS C01        , SUM(CNT) AS SUM2        , SUM(CNT) AS SUMA FROM   Z LEFT JOIN CLIMAS C ON Z.KURACD = C.CLI_CD GROUP BY Z.KURACD          , Z.acbCD          , C.CLI_NAME UNION ALL select z.kuracd,''as kuradisp,''as acbcd,'小計'as jadisp        , SUM(DECODE(z.kmcd1 ,'08',CNT,0)) AS C01        , SUM(CNT) AS SUM2        , SUM(CNT) AS SUMA from z group by kuracd UNION ALL select'XYZ'as kuracd,'総合計'as kuradisp,''as acbcd,''as jadisp        , SUM(DECODE(z.kmcd1 ,'08',CNT,0)) AS C01        , SUM(CNT) AS SUM2        , SUM(CNT) AS SUMA from z order by kuracd,acbcd 
2021/09/13 22:31:06|WITH Z AS ( SELECT KURACD        , TRIM(REPLACE(acbcd,'　','')) AS acbcd        , kmcd1        , COUNT(*) AS CNT FROM   t10_keiho WHERE  1 = 1 AND    kmYMD BETWEEN :TRGDATE_FROM AND :TRGDATE_TO GROUP BY KURACD, acbCD, kmcd1 ORDER BY KURACD, acbCD, kmcd1 ) SELECT Z.KURACD        , Z.KURACD || ':' || C.CLI_NAME AS KURADISP        , Z.acbCD        , Z.acbCD || ':' || Z.acbcd AS JADISP        , SUM(DECODE(z.kmcd1 ,'08',CNT,0)) AS C01        , SUM(CNT) AS SUM2        , SUM(CNT) AS SUMA FROM   Z LEFT JOIN CLIMAS C ON Z.KURACD = C.CLI_CD GROUP BY Z.KURACD          , Z.acbCD          , C.CLI_NAME UNION ALL select z.kuracd,''as kuradisp,''as acbcd,'小計'as jadisp        , SUM(DECODE(z.kmcd1 ,'08',CNT,0)) AS C01        , SUM(CNT) AS SUM2        , SUM(CNT) AS SUMA from z group by kuracd UNION ALL select'XYZ'as kuracd,'総合計'as kuradisp,''as acbcd,''as jadisp        , SUM(DECODE(z.kmcd1 ,'08',CNT,0)) AS C01        , SUM(CNT) AS SUM2        , SUM(CNT) AS SUMA from z order by kuracd,acbcd 
2021/09/13 22:31:18|WITH Z AS ( SELECT KURACD        , TRIM(REPLACE(acbcd,'　','')) AS acbcd        , kmcd1        , COUNT(*) AS CNT FROM   t10_keiho WHERE  1 = 1 AND    kmYMD BETWEEN :TRGDATE_FROM AND :TRGDATE_TO GROUP BY KURACD, acbCD, kmcd1 ORDER BY KURACD, acbCD, kmcd1 ) SELECT Z.KURACD        , Z.KURACD || ':' || C.CLI_NAME AS KURADISP        , Z.acbCD        , Z.acbCD || ':' || Z.acbcd AS JADISP        , SUM(DECODE(z.kmcd1 ,'08',CNT,0)) AS C01        , SUM(CNT) AS SUM2        , SUM(CNT) AS SUMA FROM   Z LEFT JOIN CLIMAS C ON Z.KURACD = C.CLI_CD GROUP BY Z.KURACD          , Z.acbCD          , C.CLI_NAME UNION ALL select z.kuracd,''as kuradisp,''as acbcd,'小計'as jadisp        , SUM(DECODE(z.kmcd1 ,'08',CNT,0)) AS C01        , SUM(CNT) AS SUM2        , SUM(CNT) AS SUMA from z group by kuracd UNION ALL select'XYZ'as kuracd,'総合計'as kuradisp,''as acbcd,''as jadisp        , SUM(DECODE(z.kmcd1 ,'08',CNT,0)) AS C01        , SUM(CNT) AS SUM2        , SUM(CNT) AS SUMA from z order by kuracd,acbcd 
